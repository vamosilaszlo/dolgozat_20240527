
<!-- 
    Mem√≥ria j√°t√©k v4.00
    V√°mosi L√°szl√≥ 2024.01.23.

  -->
<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mem√≥riaj√°t√©k</title>
    <style>
        .card {
            width: 77px;
            height: 77px;
            margin: 5px;
            display: inline-block;
            background-color: #ccc;
            text-align: center;
            line-height: 77px;
            font-size: 60px;
            /* 20px */
            cursor: pointer;
            vertical-align: middle;
        }

        #grat {
            font-size: 20px;
        }

        .kozep {
            width: 348px;
            margin: auto;
        }

        h6 {
            color: #ccc;
        }

    </style>
</head>

<body>
    <div class="kozep">
        <h1>Mem√≥riaj√°t√©k</h1>
        <label for="nev">Neved:</label>
        <input type="text" id="nev">
        <p id="turns">Ford√≠t√°sok sz√°ma: 0</p>
    </div>
    <div id="board" class="kozep"></div>
    <h6 class="kozep">V√°mosi L√°szl√≥, 2024.01.23. v4.00</h6>
    <div class="kozep"><button id="btn" class="kozep">Toggle Teljesk√©perny≈ë</button></div>

    <div id="elozo" class="kozep"></div>
    <div id="grat" class="kozep"></div>
    <script>
        function toggleTeljesKepernyo() {
            var elem = document.documentElement;

            if (
                !document.fullscreenElement &&
                !document.mozFullScreenElement &&
                !document.webkitFullscreenElement &&
                !document.msFullscreenElement
            ) {


                if (elem.requestFullscreen) {
                    elem.requestFullscreen();
                } else if (elem.mozRequestFullScreen) {
                    elem.mozRequestFullScreen();
                } else if (elem.webkitRequestFullscreen) {
                    elem.webkitRequestFullscreen();
                } else if (elem.msRequestFullscreen) {
                    elem.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }

            }

        }



            let btn = document.getElementById("btn")
            btn.addEventListener("click", toggleTeljesKepernyo);








            // K√°rtya t√≠pusok
            const animals = ['üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº'];
            // const betuk1 = ['A', 'B', 'C', 'D'];
            // const betuk2 = ['a', 'b', 'c', 'd'];
            // const betuk = ['Aa', 'Bb', 'Cc', 'Dd']
            // K√°rty√°k t√∂mbje
            const cards = [...animals, ...animals];
            // const cards=[...betuk1,...betuk1]
            // Kever√©s
            cards.sort(() => Math.random() - 0.5);

            // J√°t√©k t√°bla l√©trehoz√°sa
            const board = document.getElementById('board');
            const turnsDisplay = document.getElementById('turns');
            let flippedCards = [];
            let turns = 0;

            function createBoard() {
                for (let i = 0; i < cards.length; i++) {
                    const card = document.createElement('div');
                    card.classList.add('card');
                    card.dataset.index = i;
                    card.addEventListener('click', flipCard);
                    board.appendChild(card);
                }
            }

            function flipCard() {

                const index = this.dataset.index;
                this.textContent = cards[index];
                turns++
                turnsDisplay.textContent = `Ford√≠t√°sok sz√°ma: ${turns}`;
                this.removeEventListener('click', flipCard);
                flippedCards.push({ index, element: this });

                if (flippedCards.length === 2) {
                    setTimeout(checkMatch, 200);
                }
            }

            function checkMatch() {
                const [card1, card2] = flippedCards; //destruktur√°l√≥ kifejez√©s. 

                if (cards[card1.index] === cards[card2.index]) {
                    card1.element.style.backgroundColor = '#8aff8a';
                    card2.element.style.backgroundColor = '#8aff8a';
                    card1.element.classList.add('paired');
                    card2.element.classList.add('paired');

                    // Sikeres p√°ros√≠t√°s eset√©n

                } else {
                    card1.element.textContent = '';
                    card1.element.addEventListener('click', flipCard);
                    card2.element.textContent = '';
                    card2.element.addEventListener('click', flipCard);
                }

                flippedCards = [];

                // Ellen≈ërz√©s a h√°tt√©rsz√≠nre

                let c = document.querySelectorAll('.card[style*="background-color: rgb(138, 255, 138)"]');
                console.log("Z√∂ld k√°rty√°k sz√°ma: ", c.length);

                if (document.querySelectorAll('.card:not([style*="background-color: rgb(138, 255, 138)"])').length === 0) {
                    // Ha minden k√°rtya p√°ros√≠tva van
                    saveGameData()
                    console.log(`Gratul√°lunk! ${ujAdat.nev}, nyert√©l ${turns} ford√≠t√°ssal.`)//,

                    //document.getElementById("grat").innerText += `\n-Gratul√°lunk! ${ujAdat.nev}, nyert√©l ${turns} ford√≠t√°ssal.`
                    //document.getElementById("grat").innerHTML += "<br><h3>Gratul√°lunk! Nyert√©l " + `${turns}` + " ford√≠t√°ssal.<h3>"

                }
            }
            ujAdat = {}
            function saveGameData() {
                console.log("adat :", adat)
                // ujnev upper
                ujAdat = {
                    nev: document.getElementById('nev').value.charAt(0).toUpperCase()+ document.getElementById('nev').value.slice(1) || "n√©vtelen",
                    turns: turns,
                    datum: new Date().toLocaleString()
                }
                console.log("save: ", adat, ujAdat)
                let max = Math.max(...adat.map(o => o.turns)) || 1000
                let min = Math.min(...adat.map(o => o.turns)) || 1000
                console.log(...adat.map(o => o.turns))
                const eredetiString = ujAdat.nev;
                const modositottString = eredetiString.charAt(0).toUpperCase() + eredetiString.slice(1);

                console.log(modositottString);  // "Laci"

                let txt = `Gratul√°lunk! ${ujAdat.nev.charAt(0).toUpperCase() + eredetiString.slice(1)}, ${min > turns ? 'nyert√©l' : 'nem nyert√©l'} ${turns} ford√≠t√°ssal.`// [${min} - ${max}]` 


                adat.unshift(ujAdat)
                if (adat.length > 5) {
                    adat.pop();

                }
                console.log(adat)
                let adatString = JSON.stringify(adat)
                localStorage.setItem('lista', adatString);
                console.log(adatString)

                //

                console.log(txt)
                document.getElementById("grat").innerText += txt;
                
            }

            let adat = [];
            function loadGameData() {
                let adatString = localStorage.getItem('lista') || [];
                adat = JSON.parse(adatString)
                console.log("load-----", adatString, adat)
                document.getElementById("elozo").innerText = `El≈ëz≈ë ${adat.length} j√°t√©k:`
                for (let elem of adat) {
                    document.getElementById("elozo").innerText += `\n${elem.nev}, ${elem.turns},  ${elem.datum}`

                }
            }
            createBoard();
            loadGameData()
    </script>
</body>

</html>